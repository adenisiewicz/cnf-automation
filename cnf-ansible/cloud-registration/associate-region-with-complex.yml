- name: Prepare associate-region-with-complex.json
  copy:
    dest: tmp/associate-region-with-complex.json
    content: |
      {
          "related-to": "complex",
          "related-link": "/aai/v16/cloud-infrastructure/complexes/complex/{{region_details.complex}}",
          "relationship-data": [
            {
              "relationship-key": "complex.physical-location-id",
              "relationship-value": "{{region_details.complex}}"
            }
          ]
      }

- name: Create association Region with Complex
  uri:
    url: https://{{ONAP_k8s_IP}}:30233/aai/v16/cloud-infrastructure/cloud-regions/cloud-region/{{region_details.cloud_owner}}/{{region_details.region_id}}/relationship-list/relationship
    url_username: "{{ AAI_user }}"
    url_password: "{{ AAI_pass }}"
    force_basic_auth: yes
    headers:
      Accept: "application/json"
      Content-Type: "application/json"
      X-FromAppId: "Ansible"
      X-TransactionId: "get_aai_subscr"
    method: PUT
    status_code: 200
    return_content: yes
    validate_certs: False
    body_format: json
    body: "{{ lookup('file','tmp/associate-region-with-complex.json') }}"
